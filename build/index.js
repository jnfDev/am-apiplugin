(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var l in n)e.o(n,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:n[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.blocks,l=window.wp.blockEditor,a=window.React;var r=e.n(a);const s=window.wp.components,c=e=>{let{columns:n=[],setHiddenColumns:l,hiddenColumns:a=[]}=e;const{__,sprintf:r}=wp.i18n;return(0,t.createElement)("div",{className:"Am-ColumnsVisibility"},n.map(((e,n)=>{const c=a.includes(`column_${n}`);return(0,t.createElement)(s.ToggleControl,{label:r(__("Hide %s","am-apiplugin"),e),help:__(c?"Hidden":"Visible","am-apiplugin"),checked:c,onChange:e=>{l(e?a.concat([`column_${n}`]):a.filter((e=>e!==`column_${n}`)))}})})))},i=e=>{let{data:n,hiddenColumns:l=[]}=e;const{title:a,data:r}=n,s=r.headers.reduce(((e,t,n)=>"Date"===t?n:e),-1);return(0,t.createElement)("div",{className:"Table"},(0,t.createElement)("h4",null,a),(0,t.createElement)("table",null,(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,r.headers.filter(((e,t)=>!l.includes(`column_${t}`))).map((e=>(0,t.createElement)("th",null,e))))),(0,t.createElement)("tbody",null,Object.values(r.rows).map((e=>(0,t.createElement)("tr",null,Object.values(e).filter(((e,t)=>!l.includes(`column_${t}`))).map(((e,n)=>(n===s&&(e=new Date(e).toLocaleDateString()),(0,t.createElement)("td",null,e))))))))))},o=()=>{const{__}=wp.i18n;return(0,t.createElement)("div",{className:"Error"},(0,t.createElement)("h1",null,__("505 Error","am-apiplugin")),(0,t.createElement)("span",{class:"dashicons dashicons-dismiss"}),(0,t.createElement)("p",null,__("Something unexpected just happened. Try to reload the page.","am-apiplugin")))},d=()=>{const{__}=wp.i18n;return(0,t.createElement)("div",{className:"Loading"},(0,t.createElement)("span",{class:"dashicons dashicons-admin-site-alt3"}),(0,t.createElement)("h5",null,__("Loading...","am-apiplugin")))},u=e=>{let{attributes:n,setAttributes:a}=e;const[s,u]=r().useState(!1),{adminVars:m,data:p,hiddenColumns:E}=n;return r().useEffect((()=>{jQuery.post(m.url,{challenge_id:1,action:m.action,wpnonce:m.nonce},(e=>{let{data:t,success:n}=e;if(!n)return u(!0);a({data:t})}))}),[]),(0,t.createElement)(t.Fragment,null,s?(0,t.createElement)(o,{error:s}):p?(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.InspectorControls,{key:"setting"},(0,t.createElement)(c,{columns:null==p||null===(h=p.data)||void 0===h?void 0:h.headers,hiddenColumns:E,setHiddenColumns:e=>{a({hiddenColumns:e})}})),(0,t.createElement)(i,{data:p,hiddenColumns:E})):(0,t.createElement)(d,null));var h};(0,n.registerBlockType)("am-apiplugin/am-apiblock",{edit:e=>{let{attributes:n,setAttributes:a}=e;return(0,t.createElement)("div",(0,l.useBlockProps)(),(0,t.createElement)(u,{attributes:n,setAttributes:a}))},save:e=>{let{attributes:n}=e;const{data:a,hiddenColumns:r}=n;if(a)return(0,t.createElement)("div",l.useBlockProps.save(),(0,t.createElement)(i,{data:a,hiddenColumns:r}))}})})();