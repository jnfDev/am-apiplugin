(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var l in n)e.o(n,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:n[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.blocks,l=window.wp.blockEditor,a=window.React;var r=e.n(a);const s=window.wp.components,c=e=>{let{columns:n=[],setHiddenColumns:l,hiddenColumns:a=[]}=e;return(0,t.createElement)("div",{className:"Am-ColumnsVisibility"},n.map(((e,n)=>{const r=a.includes(`column_${n}`);return(0,t.createElement)(s.ToggleControl,{label:`Hide ${e}`,help:r?"Hidden":"Visible",checked:r,onChange:e=>{l(e?a.concat([`column_${n}`]):a.filter((e=>e!==`column_${n}`)))}})})))},o=e=>{let{data:n,hiddenColumns:l=[]}=e;const{title:a,data:r}=n;return(0,t.createElement)("div",{className:"Table"},(0,t.createElement)("h4",null,a),(0,t.createElement)("table",null,(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,r.headers.filter(((e,t)=>!l.includes(`column_${t}`))).map((e=>(0,t.createElement)("th",null,e))))),(0,t.createElement)("tbody",null,Object.values(r.rows).map((e=>(0,t.createElement)("tr",null,Object.values(e).filter(((e,t)=>!l.includes(`column_${t}`))).map((e=>(0,t.createElement)("td",null,e)))))))))},i=()=>(0,t.createElement)("div",{className:"Error"},(0,t.createElement)("h1",null,"505 Error"),(0,t.createElement)("span",{class:"dashicons dashicons-dismiss"}),(0,t.createElement)("p",null,"Something unexpected just happened. Please contact us at ",(0,t.createElement)("b",null,"some@email.com")," for more info.")),d=()=>(0,t.createElement)("div",{className:"Loading"},(0,t.createElement)("span",{class:"dashicons dashicons-admin-site-alt3"}),(0,t.createElement)("h5",null,"Loading...")),m=e=>{let{attributes:n,setAttributes:a}=e;const[s,m]=r().useState(!1),{adminVars:u,data:E,hiddenColumns:p}=n;return r().useEffect((()=>{jQuery.post(u.url,{action:u.action,wpnonce:u.nonce},(e=>{let{data:t,success:n}=e;if(!n)return m(!0);a({data:t})}))}),[]),(0,t.createElement)(t.Fragment,null,s?(0,t.createElement)(i,{error:s}):E?(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.InspectorControls,{key:"setting"},(0,t.createElement)(c,{columns:null==E||null===(h=E.data)||void 0===h?void 0:h.headers,hiddenColumns:p,setHiddenColumns:e=>{a({hiddenColumns:e})}})),(0,t.createElement)(o,{data:E,hiddenColumns:p})):(0,t.createElement)(d,null));var h};(0,n.registerBlockType)("am-apiplugin/am-apiblock",{edit:e=>{let{attributes:n,setAttributes:a}=e;return(0,t.createElement)("div",(0,l.useBlockProps)(),(0,t.createElement)(m,{attributes:n,setAttributes:a}))},save:e=>{let{attributes:n}=e;const{data:a,hiddenColumns:r}=n;if(a)return(0,t.createElement)("div",l.useBlockProps.save(),(0,t.createElement)(o,{data:a,hiddenColumns:r}))}})})();